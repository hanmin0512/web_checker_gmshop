## web_checker_gmshop
gmshop이라는 취약한사이트 취약점 검사.

## 발견 한 취약점 목록
| 점검항목             | 항목 중요도 | 항목코드 |
|---------------------|------------|---------|
| SQL Injection       | 상         | SI      |
| 디렉터리 인덱싱     | 상         | DI      |
| 정보 누출           | 상         | IL      |
| 악성 콘텐츠         | 상         | CS      |
| 크로스사이트 스크립팅 | 상       | XS      |
| 약한 문자열 강도     | 상         | BF      |
| 불충분한 인증       | 상         | IA      |
| 불충분한 인가       | 상         | IN      |
| 자동화 공격         | 상         | AU      |
| 파일 업로드         | 상         | FU      |
| 관리자 페이지 노출   | 상         | AE      |
| 데이터 평문 전송     | 상         | SN      |

## SQL Injection
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 대화형 웹 사이트에 비정상적인 사용자 입력 값 허용을 차단하여 악의적인 데이터베이스 접근 및 조작을 방지하기 위함 | 양호 : 임의로 작성된 SQL 쿼리 입력에 대한 검증이 이루어지는 경우<br>취약 : 임의로 작성된 SQL 쿼리 입력에 대한 검증이 이루어지지 않는 경우| 소스코드에 SQL 쿼리를 입력 값으로 받는 함수나 코드를 사용할 경우, 임의의 SQL 쿼리 입력에 대한 검증 로직을 구현하여 서버에 검증되지 않는 SQL 쿼리 요청 시 에러 페이지가 아닌 정상 페이지가 반환되도록 필터링 처리하고 웹 방화벽에 SQL 인젝션 관련 룰셋을 적용하여 SQL 인젝션 공격을 차단함 |

> ![sql_injection_query](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/03b00ab2-53ed-4506-bf44-3d3bbfb8a402)
> ![sql_injection_success](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/34ce420e-4904-4bb9-b2a3-7d79b8a25c3b)
- 로그인 폼에 SQL Injection 쿼리를 삽입하였을 때 로그인이 성공, SQL Injection 취약함.

## 디렉터리 인덱싱
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 디렉터리 인덱싱 취약점을 제거하여 특정 디렉터리 내 불필요한 파일 정보의 노출을 차단 | 양호 : 디렉터리 파일 리스트가 노출되지 않는 경우<br>취약 : 디렉터리 파일 리스트가 노출되는 경우 | 웹 서버 설정을 변경하여 디렉터리 파일 리스트가 노출되지 않도록 설정 |

> ![directory_indexing](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/01b0777c-a710-48d2-aa33-aff1357a994a)
- 파일을 업로드할때 저장되는 경로 url입력 후 디렉터리 인덱싱 사이트 찾음. 디렉터리 인덱싱 취약함.

## 정보 누출
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
|  웹 서비스 시 불필요한 정보가 노출되는 것을 방지함으로써 2차 공격에 활용될 수 있는 정보 노출을 차단하기 위함 | 양호 : 웹 사이트에 중요정보가 노출되지 않고, 에러 발생 시 과도한 정보가 노출되지 않는 경우<br>취약 : 웹 사이트에 중요정보가 노출되거나, 에러 발생 시 과도한 정보가 노출되는 경우 | 웹 사이트에 노출되는 중요정보는 마스킹을 적용하여야 하며, 발생 가능한 에러에 대해 최소한의 정보 또는 사전에 준비된 메시지만 출력함 |

> ![info0](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/13be974b-f967-4405-9213-19c392ddf26b)
> ![info](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/108a5695-aeb1-4497-8e85-b0eeba7c03f5)
- 비밀번호 변경 시도 후 개인정보 및 회원정보 노출. 정보노출 취약함.

## 악성 콘텐츠
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
|  사이트 내 악의적인 콘텐츠 삽입 및 실행을 방지하기 위함 | 양호 : 악의적 콘텐츠가 실행되지 않는 경우<br>취약 : 악의적 콘텐츠가 입력되며, 실행되는 경우 | 사용자 입력 값에 대한 검증 로직 추가 및 실행 제한 설정 |

> ![image](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/ffa90a94-862e-49fe-aacd-f8ed4eba987a)
> ![tempsnip](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/a54c0973-f47f-43b0-afe3-e157f98f26d2)

- 필터링을 자바스크립트로 구현하여 개발자도구를 활용하여 코드 부분을 제거하면 웹쉘 파일 업로드 및 실행 가능. 악성콘텐츠 취약함.

## 크로스 사이트 스크립팅
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 웹 사이트 내 크로스사이트 스크립팅 취약점을 제거하여 악성 스크립트의 실행을 차단 | 양호 : 사용자 입력 값에 대한 검증 및 필터링이 이루어지는 경우<br>취약 : 사용자 입력 값에 대한 검증 및 필터링이 이루어지지 않으며, HTML 코드가 입력·실행되는 경우 | 웹 사이트의 게시판, 1:1 문의, URL 등에서 사용자 입력 값에 대해 검증 로직을 추가하거나 입력되더라도 실행되지 않게 하고, 부득이하게 웹페이지에서 HTML을 사용하는 경우 HTML 코드 중 필요한 코드에 대해서만 입력되게 설정 |

> ![xss](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/60bf88f1-f827-4cec-a9cc-4d1d354ed283)
> ![xss_title](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/3814f0b8-9e41-45ad-abb6-23d9e6e5b828)
> ![xss_name](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/4a255d72-1760-485a-824d-a459c9d5f084)
> ![xss_subject](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/57e81730-40c6-4eb5-8166-35d85ddd3cb5)
- 게시물 등록과 같이 개발된 폼에 XSS코드 삽입시 코드 실행됨. XSS취약함.


## 약한 문자열 강도
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
|  유추 가능한 취약한 문자열 사용을 제한하여 계정 및 패스워드 추측 공격을 방지하기 위함 | 양호 : 관리자 계정 및 패스워드가 유추하기 어려운 값으로 설정되어 있으며,일정 횟수 이상 인증 실패 시 로그인을 제한하고 있는 경우<br>취약 : 관리자 계정 및 패스워드가 유추하기 쉬운 값으로 설정되어 있으며, 일정 횟수 이상 인증 실패 시 로그인을 제한하고 있지 않은 경우 | 계정 및 비밀번호의 체크 로직 추가 구현 |

> ![easy_string](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/a4e9e540-6c07-48d2-899c-3edeb4a5eedf)
> ![image](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/f2e231dd-6375-48d2-a605-bbc2b3e47c60)
- 관리자 페이지 관리자 계정이 admin/admin으로 유추하기 쉬운 값으로 설정됨. 약한 문자열 강도 취약함.


## 불충분한 인증

| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 중요 페이지에 추가 인증으로 접근을 강화하여 불필요한 정보의 노출 및 변조를 차단하기 위함 | 양호 : 중요정보 페이지 접근 시 추가 인증을 하는 경우<br>취약 : 중요정보 페이지 접근에 대한 추가 인증을 하지 않는 경우 | 중요정보 페이지에 대한 추가 인증 로직 추가 구현 |

> ![image](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/1cf226da-0e91-4df3-ab78-c03be00f69f7)
> ![image](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/b4dcaa86-1bf3-4036-b6a8-b6822a957a58)
- 개인정보를 보호하는 마이페이지에 접근할때 재인증 없이 접근 가능. 불충분한 인증 취약함.

## 불충분한 인가
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 접근 권한에 대한 검증 로직을 구현하여 비인가자의 악의적인 접근을 차단하기 위함 | 양호 : 접근제어가 필요한 중요 페이지의 통제수단이 적절하여 비인가자의 접근이 불가능한 경우<br>취약 : 접근제어가 필요한 중요 페이지의 통제수단이 미흡하여 비인가자의 접근이 가능한 경우 | 접근제어가 필요한 모든 페이지에 권한검증 로직 구현 |

> ![before_auth_update](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/6a50d1a6-8633-4e4e-bcfa-1af6f9428bf5)
> ![after_update_auth](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/6e7f8efb-dc8f-4492-8a02-afbb8a6217a7)
> ![Authorization_form](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/8cfb587c-8303-40a9-982a-5544f1db4aff)
> ![Authorization_update](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/c93dbcba-8b1a-4b4a-8c45-a8f444025964)

- 자신의 게시물 수정버튼을 누른후 자신의 게시물 uri에서 다른 게시물의 uri 값으로 변조하면 별다른 인증 없이 다른 게시물에 대한 권한 획득

## 자동화 공격
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 무차별 대입 공격 및 자동화 공격으로 웹 애플리케이션에 자원이 고갈되는 것을 방지하기 위함 | 양호 : 웹 애플리케이션의 특정 프로세스에 대한 반복적인 요청 시 통제가 적절한 경우<br>취약 : 웹 애플리케이션의 특정 프로세스에 대한 반복적인 요청 시 통제가 미흡한 경우 | 웹 애플리케이션의 특정 프로세스에 대한 대량 사용 통제 로직 구현 및 웹 방화벽 룰셋 설정을 통해 대량의 불특정 프로세스 요청 차단 |

> ![auto_attack_intruder](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/46606a66-b27c-441e-b14f-12b5bf10be86)
> ![brute_force_suc](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/093ffe17-64dd-45a3-aec0-bd637f77730c)
- burpsuite intruder를 사용하여 자동화 bruteforce공격을 하였을 때 성공. 자동화 공격에 취약함.

## 파일 업로드
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 업로드되는 파일의 확장자에 대한 적절성 여부를 검증하는 로직을 통해 공격자가 조작된 Server Side Script 파일 업로드 방지 및 서버상에 저장된 경로를 유추하여 해당 Server Side Script 파일 실행을 불가능하게 하기 위함 | 양호 : 업로드되는 파일에 대한 확장자 검증이 이루어지는 경우<br>취약 : 업로드되는 파일에 대한 확장자 검증이 이루어지지 않는 경우 | 업로드되는 파일에 대한 확장자 검증 및 실행 권한 제거 |

> ![file_upload_form](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/36f3b897-285e-4552-a276-bff09bcf835b)
> ![fileuploads_vuln](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/d084c394-dbc3-4250-bce4-38ee65dcd4f8)
> ![file_upload](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/8fc3d4ef-2527-4c94-9bfe-7fb00665a569)
> ![file_upload_webshell](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/d4afe2f0-4fc5-486c-af47-e7040de303a8)
- 파일업로드 할때 burpsuite로 프록시에서 넘어갈때 확장자를 jpg에서 php로 변경하여 업로드 및 실행 성공. 파일 업로드 취약함.

## 관리자 페이지 노출
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 관리자 페이지 URL이 유추하기 쉬운 이름(admin, manager 등) 및 웹 사이트 설계 오류를 수정하여 비인가자의 관리자 메뉴 접근을 방지하고자 함 | 양호 : 유추하기 쉬운 URL로 관리자 페이지 접근이 불가능한 경우<br>취약 : 유추하기 쉬운 URL로 관리자 페이지 접근이 가능한 경우 | 유추하기 어려운 이름(포트 번호 변경 포함)으로 관리자 페이지를 변경하여 비인가자가 관리자 페이지에 접근할 수 없도록 하고 근본적인 해결을 위해 지정된 IP만 관리자 페이지에 접근할 수 있도록 제한하여야 함단, 부득이하게 관리자 페이지를 외부에 노출해야 하는 경우 관리자 페이지 로그인 시 2차 인증(otp, vpn, 인증서 등) 적용 필요함 |

> ![image](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/2ca62be8-ce26-4d89-bf19-427b311e34ae)
> ![easy_string](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/d4afea6a-9eb7-406d-a14c-73621b4d5fc1)
> ![image](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/f2e231dd-6375-48d2-a605-bbc2b3e47c60)

- 관리자페이지 url이 ~~/admin이며 아이디/비밀번호가 admin/admin 이다. 관리자 페이지 노출 취약함.

## 데이터 평문 전송
| 점검 목적               | 판단 기준                             | 조치 방법                                   |
|-----------------------|----------------------------------------------------------|-------------------------------------------|
| 서버와 클라이언트 간 통신 시 데이터의 암호화 전송 미흡으로 정보 유출의 위험을 방지하고자 함 | 양호 : 중요정보 전송구간에 암호화 통신이 적용된 경우<br>취약 : 중요정보 전송구간에 암호화 통신이 이루어지지 않는 경우 | 사이트의 중요정보 전송구간(로그인, 회원가입, 회원정보관리, 게시판 등) 암호화 통신(https, 애플리케이션방식) 적용 |

> ![image](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/f9fa72c1-e1da-4504-aea6-eca8383888e0)
> ![image](https://github.com/hanmin0512/web_checker_gmshop/assets/37041208/56a1d46e-d872-4d94-83c9-31f36c217f81)

- 로그인시 burpsuite로 패킷을 intercept했을 때 데이터 평문전송된걸 확인. 데이터 평문전송 취약함.











